<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>N√©met‚ÄìMagyar Flashcard Scanner</title>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js"></script>
<style>
body { font-family: Arial, sans-serif; padding: 20px; }
#video { width: 100%; max-width: 400px; border: 2px solid #ccc; border-radius: 8px; }
button { padding: 10px 15px; margin-top: 10px; font-size: 16px; }
.flashcard {
  width: 250px; height: 150px; border: 2px solid #333;
  border-radius: 12px; display: flex; justify-content: center;
  align-items: center; font-size: 22px; margin: 15px;
  cursor: pointer; box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
}
#cards { display: flex; flex-wrap: wrap; }
</style>
</head>
<body>

<h2>Munkaf√ºzet szavak szkennel√©se (N√©met ‚Üí Magyar)</h2>

<video id="video" autoplay></video><br>
<button onclick="capture()">üì∏ K√©p beolvas√°sa</button>
<button onclick="generateCards()">üÉè Flashcardok gener√°l√°sa</button>

<h3>Felismerett sz√≥p√°rok:</h3>
<pre id="output"></pre>

<h3>Tanul√≥k√°rty√°k:</h3>
<div id="cards"></div>

<canvas id="canvas" style="display:none"></canvas>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let wordPairs = [];
let showingGerman = true;

// Kamera ind√≠t√°sa
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => video.srcObject = stream);

// K√©p k√©sz√≠t√©se + OCR futtat√°sa
function capture() {
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  ctx.drawImage(video, 0, 0);

  Tesseract.recognize(canvas, "deu+hun")
    .then(res => {
      const text = res.data.text;
      extractWords(text);
    });
}

// Sz√≥p√°rok kinyer√©se a sz√∂vegb≈ël
function extractWords(text) {
  const regex = /(.+?)([-‚Äì=])(.+)/g;
  let match;

  while ((match = regex.exec(text)) !== null) {
    let german = match[1].trim();
    let hungarian = match[3].trim();

    if (german && hungarian && german.length < 40 && hungarian.length < 40) {
      wordPairs.push({ german, hungarian });
      wordPairs = [...new Map(wordPairs.map(p => [p.german, p])).values()];
    }
  }

  document.getElementById("output").innerText =
    wordPairs.map(p => `${p.german} ‚Üí ${p.hungarian}`).join("\n");
}

// Flashcardok megjelen√≠t√©se
function generateCards() {
  const container = document.getElementById("cards");
  container.innerHTML = "";

  wordPairs.forEach(pair => {
    const card = document.createElement("div");
    card.className = "flashcard";
    card.innerText = pair.german;
    card.dataset.de = pair.german;
    card.dataset.hu = pair.hungarian;
    card.onclick = () => {
      card.innerText = card.innerText === pair.german ? pair.hungarian : pair.german;
    };
    container.appendChild(card);
  });
}
</script>

</body>
</html>
